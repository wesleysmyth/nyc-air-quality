<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Brooklyn Neighborhood Air Quality — Williamsburg Highlighted (2023)</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      margin: 12px;
      background: #fff;
      color: #111;
    }
    h1 { font-size: 20px; margin: 8px 0 16px; }
    h2 { font-size: 16px; margin: 12px 0 8px; }
    .note { font-size: 12px; color: #555; margin-top: 6px; }
  </style>
</head>
<body>
<h1>Brooklyn Neighborhood Air Quality — Williamsburg Highlighted (2023)</h1>

<div id="chart"></div>

<div class="note">
  Dropdown lets you switch between PM2.5, NO₂, O₃, and Black Carbon.<br>
  Williamsburg is highlighted in amber.
</div>

<script>
const dataByPollutant = {
  "PM2.5 (µg/m³)": {
    y: ["Bath Beach","Bay Ridge","Bensonhurst","Borough Park","Brighton Beach","Brownsville","Bushwick South","Bushwick North","Canarsie","Carroll Gardens-Cobble Hill-Gowanus","Clinton Hill","Crown Heights North","Crown Heights South","Downtown Brooklyn-DUMBO-Boerum Hill","East Flatbush-Farragut","East New York","Flatbush","Flatlands","Fort Greene","Gravesend","Greenpoint","Kensington-Windsor Terrace","Midwood","Ocean Parkway South","Park Slope-Gowanus","Prospect Heights","Sheepshead Bay","Sunset Park East","Sunset Park West","Williamsburg"],
    x: [6.5,6.4,6.6,6.7,6.8,7.1,7.0,7.3,6.6,6.9,7.1,7.2,7.3,7.4,6.9,7.2,6.9,6.6,7.2,6.5,6.9,6.8,6.8,6.7,7.1,7.2,6.8,7.0,7.1,7.2]
  },
  "NO₂ (ppb)": {
    y: ["Bath Beach","Bay Ridge","Bensonhurst","Borough Park","Brighton Beach","Brownsville","Bushwick South","Bushwick North","Canarsie","Carroll Gardens-Cobble Hill-Gowanus","Clinton Hill","Crown Heights North","Crown Heights South","Downtown Brooklyn-DUMBO-Boerum Hill","East Flatbush-Farragut","East New York","Flatbush","Flatlands","Fort Greene","Gravesend","Greenpoint","Kensington-Windsor Terrace","Midwood","Ocean Parkway South","Park Slope-Gowanus","Prospect Heights","Sheepshead Bay","Sunset Park East","Sunset Park West","Williamsburg"],
    x: [12,11,13,14,15,17,16,18,13,15,16,17,18,20,15,18,16,13,19,12,15,14,15,14,18,17,14,16,17,18]
  },
  "O₃ (ppb, summer mean)": {
    y: ["Bath Beach","Bay Ridge","Bensonhurst","Borough Park","Brighton Beach","Brownsville","Bushwick South","Bushwick North","Canarsie","Carroll Gardens-Cobble Hill-Gowanus","Clinton Hill","Crown Heights North","Crown Heights South","Downtown Brooklyn-DUMBO-Boerum Hill","East Flatbush-Farragut","East New York","Flatbush","Flatlands","Fort Greene","Gravesend","Greenpoint","Kensington-Windsor Terrace","Midwood","Ocean Parkway South","Park Slope-Gowanus","Prospect Heights","Sheepshead Bay","Sunset Park East","Sunset Park West","Williamsburg"],
    x: [26,27,26,25,25,24,23,23,25,24,23,22,22,21,24,23,24,25,22,26,24,25,25,26,23,22,25,24,23,23]
  },
  "Black Carbon (absorbance units)": {
    y: ["Bath Beach","Bay Ridge","Bensonhurst","Borough Park","Brighton Beach","Brownsville","Bushwick South","Bushwick North","Canarsie","Carroll Gardens-Cobble Hill-Gowanus","Clinton Hill","Crown Heights North","Crown Heights South","Downtown Brooklyn-DUMBO-Boerum Hill","East Flatbush-Farragut","East New York","Flatbush","Flatlands","Fort Greene","Gravesend","Greenpoint","Kensington-Windsor Terrace","Midwood","Ocean Parkway South","Park Slope-Gowanus","Prospect Heights","Sheepshead Bay","Sunset Park East","Sunset Park West","Williamsburg"],
    x: [1.0,0.9,1.1,1.2,1.1,1.4,1.3,1.5,1.1,1.3,1.4,1.5,1.5,1.6,1.3,1.5,1.3,1.1,1.6,1.0,1.3,1.2,1.2,1.1,1.4,1.5,1.2,1.3,1.4,1.6]
  }
};

// Initial pollutant
let pollutant = "PM2.5 (µg/m³)";
function makeTrace(p) {
  const ys = dataByPollutant[p].y;
  const xs = dataByPollutant[p].x;
  const colors = ys.map(y => y === "Williamsburg" ? "#E39D26" : "#C9CCD1");
  return {
    type: "bar",
    orientation: "h",
    y: ys,
    x: xs,
    marker: { color: colors, line: { color: "#DADDE2", width: 0.5 } },
    hovertemplate: "%{y}<br>" + p + ": %{x:.2f}<extra></extra>"
  };
}

const pollutants = Object.keys(dataByPollutant);
const frames = pollutants.map(p => ({
  name: p,
  data: [makeTrace(p)],
  layout: { title: `Brooklyn Neighborhoods — ${p} (2023)`, xaxis: { title: p } }
}));

const layout = {
  title: `Brooklyn Neighborhoods — ${pollutant} (2023)`,
  xaxis: { title: pollutant },
  yaxis: { title: "Neighborhood (NTA)" },
  margin: { l: 160, r: 40, t: 80, b: 60 },
  updatemenus: [{
    type: "dropdown",
    direction: "down",
    x: 1.0,
    xanchor: "right",
    y: 1.1,
    yanchor: "top",
    buttons: pollutants.map(p => ({
      label: p,
      method: "animate",
      args: [[p], { mode: "immediate", transition: { duration: 300 } }]
    }))
  }],
  annotations: [
    { text: "Williamsburg highlighted", xref: "paper", yref: "paper",
      x: 0, y: 1.08, showarrow: false, font: { size: 12, color: "#555" } }
  ]
};

Plotly.newPlot("chart", [makeTrace(pollutant)], layout)
  .then(() => Plotly.addFrames("chart", frames));
</script>
</body>
</html>
